<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Mappa Meteo Genova</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@500&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/justgage/1.6.1/justgage.min.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <!-- Pulsante per andare alla tabella -->
<button id="btnTable" style="
  position: fixed;
  top: 16px;
  right: 16px;
  z-index: 1000;
  background-color: #2563eb;
  color: white;
  padding: 8px 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
">
  Vai alla tabella
</button>

<script>
  document.getElementById('btnTable').addEventListener('click', function() {
    // Per ora apriamo una pagina vuota o placeholder
    window.location.href = "tabella.html"; // crea tabella.html più avanti
  });
</script>


  <style>
    body {
      margin: 0;
      font-family: "Inter", sans-serif;
    }
    #menu {
      position: absolute;
      top: 10px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1000;
      background: white;
      padding: 8px 12px;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
    #map {
      height: 100vh;
      width: 100%;
    }
    .circle-label {
      color: white;
      border-radius: 50%;
      font-weight: 500;
      font-size: 9px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Inter", sans-serif;
      width: 25px;
      height: 25px;
    }
    .circle-label2 {
      color: white;
      border-radius: 50%;
      font-weight: 0;
      font-size: 0px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Inter", sans-serif;
      width: 0px;
      height: 0px;
    }
  </style>
</head>
<body>
  <div id="menu">
    <label for="tempSelect"><b>Dati:</b></label>
    <select id="tempSelect">
      <option value="current">Temperatura</option>
      <option value="max">T Max</option>
      <option value="min">T Min</option>
      <option value="dewpt">Dewpoint</option>
      <option value="dewpMax">Dp Max</option>
      <option value="dewpMin">Dp Min</option>
      <option value="Heat">Heat Index</option>
      <option value="HeatMax">Ht Max</option>
      <option value="HeatMin">Ht Min</option>
      <option value="hum">Umidità</option>
      <option value="humMax">UR Max</option>
      <option value="humMin">UR Min</option>
      <option value="rainDay">Pioggia 24h</option>
      <option value="rainRate">Rain Rate</option>
      <option value="wind">Vento</option>
      <option value="winddirection">Direzione</option>
      <option value="windGust">Raffica</option>
      <option value="windGustMax">Raffica Max</option>

    </select>
  </div>

  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // ----- Configurazione Mappa -----
    const map = L.map('map').setView([44.423, 8.972], 12);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // ----- API Key -----
    const apiKey = 'e1f10a1e78da46f5b10a1e78da96f525';

    // ----- Lista Stazioni -----
    const stationsBest = {
      
  IGENOA58: { api: "IGENOA58" },
  IBARGAGL5: { api: "IBARGAGL5" },
  IBOGLI8: { api: "IBOGLI8" },
  IDAVAG2: { api: "IDAVAG2" },
  ITORRI4: { api: "ITORRI4" },
  IMONTO47: { api: "IMONTO47" },
  IGENOA3078: { api: "IGENOA2728" },
  IGENOA2767: { api: "IGENOA2767" },
  IGENOA2775: { api: "IGENOA2775" },
  IGENOA2800: { api: "IGENOA2800" },
  IGENOA2819: { api: "IGENOA2819" },
  IGENOA2833_: { api: "IGENOA2833" },
  IGENOA2841: { api: "IGENOA2841" },
  IGENOA2843: { api: "IGENOA2843" },
  IGENOA2846: { api: "IGENOA2846" },
  IGENOA2857: { api: "IGENOA2857" },
  IGENOA2865: { api: "IGENOA2865" },
  IGENOA2881: { api: "IGENOA2881" },
  IGENOA2887: { api: "IGENOA2887" },
  IGENOA2895: { api: "IGENOA2895" },
  IGENOA2933: { api: "IGENOA2933" },
  IGENOA2959: { api: "IGENOA2959" },
  IGENOA2962: { api: "IGENOA2962" },
  IGENOA2970: { api: "IGENOA2970" },
  IGENOA2971: { api: "IGENOA2971" },
  IGENOA2980: { api: "IGENOA2980" },
  IGENOA2983: { api: "IGENOA2983" },
  IGENOA2984: { api: "IGENOA2984" },
  IGENOA2987: { api: "IGENOA2987" },
  IGENOA2991: { api: "IGENOA2991" },
  IGENOA2997: { api: "IGENOA2997" },
  IGENOA3005: { api: "IGENOA3005" },
  IGENOA3007: { api: "IGENOA3007" },
  IGENOA3019: { api: "IGENOA3019" },
  IGENOA3021: { api: "IGENOA3021" },
  IGENOA3032: { api: "IGENOA3032" },
  IGENOA3035: { api: "IGENOA3035" },
  IGENOA3052: { api: "IGENOA3052" },
  IGENOA3058: { api: "IGENOA3058" },
  IGENOA3069: { api: "IGENOA3069" },
  IGENOA3085: { api: "IGENOA3085" },
  IGENOA3101: { api: "IGENOA3101" },
  IGENOA2763: { api: "IGENOA2763" },
  IGENOA3027: { api: "IGENOA3027" },
  ILIGURIA67: { api: "ILIGURIA67" },
  IGENOA3104: { api: "IGENOA3104" },
  IGENOA2831: { api: "IGENOA2831" },
  IGENOA3041: { api: "IGENOA3041" },
  IGENOA2960: { api: "IGENOA2960" },
  IGENOA2969: { api: "IGENOA2969" },
  IGENOA3077: { api: "IGENOA3077" },
  IGENOVAA2: { api: "IGENOVAA2" },
  IGENOVAN1: { api: "IGENOVAN1" },
  IBOGLI8: { api: "IBOGLI8" },
  IBOGLI12: { api: "IBOGLI12" },
  IPIEVE46: { api: "IPIEVE46" },
  IGENOA2870: { api: "IGENOA2870" },
  IGENOA3055: { api: "IGENOA3055" },
};

    const stations = {
  IACQUI10: { api: "IACQUI10" }, 
  IALBAR21: { api: "IALBAR21" },
  IBEDON8: { api: "IBEDON8" },
  IITALIA8: { api: "IITALIA8" },
  IALBAR26: { api: "IALBAR26" },
  IBORGO129: { api: "IBORGO129" },
  IACQUI19: { api: "IACQUI19" },
  IBISTA1: { api: "IBISTA1" },
  IBUBBI1: { api: "IBUBBI1" },
  ICANEL29: { api: "ICANEL29" },
  IAGLIA8: { api: "IAGLIA8" },
  ICOSTI5: { api: "ICOSTI5" },
  ICOSTI9: { api: "ICOSTI9" },
  ICOSTI13: { api: "ICOSTI13" },
  ICOSTI16: { api: "ICOSTI16" },
  ICOSTI18: { api: "ICOSTI18" },
  IALASS4: { api: "IALASS4" },
  IALBA46: { api: "IALBA46" },
  IALBEN12: { api: "IALBEN12" },
  IALBEN13: { api: "IALBEN13" },
  IALBIS15: { api: "IALBIS15" },
  IALBIS17: { api: "IALBIS17" },
  IALESS19: { api: "IALESS19" },
  IALESS20: { api: "IALESS20" },
  IALESS22: { api: "IALESS22" },
  IALLUV5: { api: "IALLUV5" },
  IALTAR9: { api: "IALTAR9" },
  IANDOR36: { api: "IANDOR36" },
  IANDOR38: { api: "IANDOR38" },
  IANDOR45: { api: "IANDOR45" },
  ICALIZ2: { api: "ICALIZ2" },
  IPIETR53: { api: "IPIETR53" },
  IMARMO9: { api: "IMARMO9" },
  ICASTE724: { api: "ICASTE724" },
  IOSTAN1: { api: "IOSTAN1" },
  IBAGNO61: { api: "IBAGNO61" },
  IPRALI9: { api: "IPRALI9" },
  IPRALI3: { api: "IPRALI3" },
  ISESTR42: { api: "ISESTR42" },
  ISAUZE2: { api: "ISAUZE2" },
  IBELLI49: { api: "IBELLI49" },
  IARCOL18: { api: "IARCOL18" },
  IARNAS13: { api: "IARNAS13" },
  IASTI37: { api: "IASTI37" },
  IASTI39: { api: "IASTI39" },
  IASTI54: { api: "IASTI54" },
  IBAGNA27: { api: "IBAGNA27" },
  IBALDI160: { api: "IBALDI160" },
  IBARGAGL5: { api: "IBARGAGL5" },
  IBEINE9: { api: "IBEINE9" },
  IBOGLI8: { api: "IBOGLI8" },
  IBONAS9: { api: "IBONAS9" },
  IBORGO125: { api: "IBORGO125" },
  IBORGH21: { api: "IBORGH21" },
  IBOVES17: { api: "IBOVES17" },
  IBOVES27: { api: "IBOVES27" },
  IBOVES31: { api: "IBOVES31" },
  IBOZZO4: { api: "IBOZZO4" },
  IBRA535:  { api: "IBRA535" },
  IBRALL2: { api: "IBRALL2" },
  IBRIGA11: { api: "IBRIGA11" },
  IBRIGA19: { api: "IBRIGA19" },
  IBRUGN23: { api: "IBRUGN23" },
  IBUSAL1: { api: "IBUSAL1" },
  IBUSAL3: { api: "IBUSAL3" },
  IBUTTI12: { api: "IBUTTI12" },
  ICAIRO36: { api: "ICAIRO36" },
  ICAIROMO3: { api: "ICAIROMO3" },
  ICAMER8: { api: "ICAMER8" },
  ICAMPO219: { api: "ICAMPO219" },
  ICAMPOMO4: { api: "ICAMPOMO4" },
  ICAPANNO16: { api: "ICAPANNO16" },
  ICASSA19: { api: "ICASSA19" },
  ICASTE229: { api: "ICASTE229" },
  ICASTE241: { api: "ICASTE241" },
  ICASTE932: { api: "ICASTE932" },
  ICALIC1_: { api: "ICALIC1" },
  ICALIC3: { api: "ICALIC3" },
  ICALIZ13: { api: "ICALIZ13" },
  ICALOS1: { api: "ICALOS1" },
  ICAMOG7: { api: "ICAMOG7" },
  ICAMPO57: { api: "ICAMPO57" },
  ICARAS4: { api: "ICARAS4" },
  ICARBO36: { api: "ICARBO36" },
  ICARIG15: { api: "ICARIG15" },
  ICARMA33: { api: "ICARMA33" },
  ICARMA35: { api: "ICARMA35" },
  ICARRA91: { api: "ICARRA91" },
  ICARRO37: { api: "ICARRO37" },
  ICASAL53: { api: "ICASAL53" },
  ICASAL85: { api: "ICASAL85" },
  ICASAR73: { api: "ICASAR73" },
  ICASEL6: { api: "ICASEL6" },
  ICASSI26: { api: "ICASSI26" },
  ICASTE241: { api: "ICASTE241" },
  ICASTE560: { api: "ICASTE560" },
  ICASTE1086: { api: "ICASTE1086" },
  ICASTI67: { api: "ICASTI67" },
  ICENGI4: { api: "ICENGI4" },
  ICENTA4: { api: "ICENTA4" },
  ICERAN6: { api: "ICERAN6" },
  ICERES22: { api: "ICERES22" },
  ICERIA1: { api: "ICERIA1" },
  ICESSO17: { api: "ICESSO17" },
  ICEVA7: { api: "ICEVA7" },
  ICHERA3: { api: "ICHERA3" },
  ICHERA4: { api: "ICHERA4" },
  ICHERA5: { api: "ICHERA5" },
  ICHIAV1: { api: "ICHIAV1" },
  ICHIAV4: { api: "ICHIAV4" },
  ICHIAV7: { api: "ICHIAV7" },
  ICHIAV12: { api: "ICHIAV12" },
  ICHIUS13: { api: "ICHIUS13" },
  ICHIUS15: { api: "ICHIUS15" },
  ICICAG1: { api: "ICICAG1" },
  ICOGOL7: { api: "ICOGOL7" },
  ICOGOL47: { api: "ICOGOL47" },
  ICOGOL52: { api: "ICOGOL52" },
  ICORTE57: { api: "ICORTE57" },
  ICREMO15: { api: "ICREMO15" },
  ICROCE7: { api: "ICROCE7" },
  IDAVAG2: { api: "IDAVAG2" },
  IDIANO12: { api: "IDIANO12" },
  IDOLCE9: { api: "IDOLCE9" },
  IDOGLI1: { api: "IDOGLI1" },
  IDERNI2: { api: "IDERNI2" },
  IDUSIN1: { api: "IDUSIN1" },
  IFABBR5: { api: "IFABBR5" },
  IFARIG1: { api: "IFARIG1" },
  IFERRIER5: { api: "IFERRIER5" },
  IFILIG4: { api: "IFILIG4" },
  IFOLLO7: { api: "IFOLLO7" },
  IFINAL12: { api: "IFINAL12" },
  IFOSSA15: { api: "IFOSSA15" },
  IFOSSANO8: { api: "IFOSSANO8" },
  IGAMAL1: { api: "IGAMAL1" },
  IGARES3: { api: "IGARES3" },
  IGAVI6: { api: "IGAVI6" },
  IGAVI7: { api: "IGAVI7" },
  IGENOA58: { api: "IGENOA58" },
  IGENOA3078: { api: "IGENOA2728" },
  IGENOA2767: { api: "IGENOA2767" },
  IGENOA2800: { api: "IGENOA2800" },
  IGENOA2819: { api: "IGENOA2819" },
  IGENOA2833_: { api: "IGENOA2833" },
  IGENOA2841: { api: "IGENOA2841" },
  IGENOA2843: { api: "IGENOA2843" },
  IGENOA2846: { api: "IGENOA2846" },
  IGENOA2857: { api: "IGENOA2857" },
  IGENOA2865: { api: "IGENOA2865" },
  IGENOA2881: { api: "IGENOA2881" },
  IGENOA2870: { api: "IGENOA2870" },
  IGENOA3055: { api: "IGENOA3055" },
  IGENOA2887: { api: "IGENOA2887" },
  IGENOA2895: { api: "IGENOA2895" },
  IGENOA2933: { api: "IGENOA2933" },
  IGENOA2959: { api: "IGENOA2959" },
  IGENOA2960: { api: "IGENOA2960" },
  IGENOA2962: { api: "IGENOA2962" },
  IGENOA2969: { api: "IGENOA2969" },
  IGENOA2970: { api: "IGENOA2970" },
  IGENOA2971: { api: "IGENOA2971" },
  IGENOA2980: { api: "IGENOA2980" },
  IGENOA2983: { api: "IGENOA2983" },
  IGENOA2984: { api: "IGENOA2984" },
  IGENOA2987: { api: "IGENOA2987" },
  IGENOA2991: { api: "IGENOA2991" },
  IGENOA2997: { api: "IGENOA2997" },
  IGENOA3005: { api: "IGENOA3005" },
  IGENOA3007: { api: "IGENOA3007" },
  IGENOA3019: { api: "IGENOA3019" },
  IGENOA3021: { api: "IGENOA3021" },
  IGENOA3032: { api: "IGENOA3032" },
  IGENOA3035: { api: "IGENOA3035" },
  IGENOA3052: { api: "IGENOA3052" },
  IGENOA3058: { api: "IGENOA3058" },
  IGENOA3069: { api: "IGENOA3069" },
  IGENOA3077: { api: "IGENOA3077" },
  IGENOA3085: { api: "IGENOA3085" },
  IGENOA3104: { api: "IGENOA3104" },
  IGENOA2831: { api: "IGENOA2831" },
  IGENOA3041: { api: "IGENOA3041" },
  IGENOVAA2: { api: "IGENOVAA2" },
  IGENOVAN1: { api: "IGENOVAN1" },
  IBOGLI12: { api: "IBOGLI12" },
  IPIEVE46: { api: "IPIEVE46" },
  IGROND1: { api: "IGROND1" },
  IISOLA59: { api: "IISOLA59" },
  IISOLDA1: { api: "IISOLDA1" },
  ILAIGU19: { api: "ILAIGU19" },
  ILERIC8: { api: "ILERIC8" },
  ILEQUI3: { api: "ILEQUI3" },
  ILEVAN16: { api: "ILEVAN16" },
  ILIGURIA2: { api: "ILIGURIA2" },
  ILIGURIA20: { api: "ILIGURIA20" },
  ILIGURIA51: { api: "ILIGURIA51" },
  ILIGURIA88: { api: "ILIGURIA88" },
  ILIGURIA123: { api: "ILIGURIA123" },
  ILIGURIA175: { api: "ILIGURIA175" },
  ILIGURIA181: { api: "ILIGURIA181" },
  ILIGURIA186: { api: "ILIGURIA186" },
  ILIMON9: { api: "ILIMON9" },
  ILIMON17: { api: "ILIMON17" },
  ILIMON19: { api: "ILIMON19" },
  ILOMBARD405: { api: "ILOMBARD405" },
  ILGFORNA4: { api: "ILGFORNA4" },
  ILUCCA69: { api: "ILUCCA69" },
  ILUCIN14: { api: "ILUCIN14" },
  IMACCA6: { api: "IMACCA6" },
  IMALLA14: { api: "IMALLA14" },
  IMASON4: { api: "IMASON4" },
  IMASON6: { api: "IMASON6" },
  IMASSA43: { api: "IMASSA43" },
  IMEDE8: { api: "IMEDE8" },
  IMELE15: { api: "IMELE15" },
  IMELE16_: { api: "IMELE16" },
  IMENDA13: { api: "IMENDA13" },
  IMENDA14: { api: "IMENDA14" },
  IMERAN2: { api: "IMERAN2" },
  IMIGNA23: { api: "IMIGNA23" },
  IMILLE3: { api: "IMILLE3" },
  IMOCON1: { api: "IMOCON1" },
  IMOLAR2: { api: "IMOLAR2" },
  IMONEG33: { api: "IMONEG33" },
  IMONGI4: { api: "IMONGI4" },
  IMONTA172: { api: "IMONTA172" },
  IMONTE1010: { api: "IMONTE1010" },
  IMONTO93: { api: "IMONTO93" },
  IMORSA15: { api: "IMORSA15" },
  IMONFO5: { api: "IMONFO5" },
  IMONTO47: { api: "IMONTO47" },
  IMURAZ6: { api: "IMURAZ6" },
  IMURIALD2: { api: "IMURIALD2" },
  INEIRO1: { api: "INEIRO1" },
  INEIRO2: { api: "INEIRO2" },
  INEIVE1: { api: "INEIVE1" },
  INOVEL23: { api: "INOVEL23" },
  INOVIL12: { api: "INOVIL12" },
  INOVIL17: { api: "INOVIL17" },
  INOVIL34: { api: "INOVIL34" },
  INOVILIG13: { api: "INOVILIG13" },
  IONZO2: { api: "IONZO2" },
  IORMEA3: { api: "IORMEA3" },
  IORMEA11: { api: "IORMEA11" },
  IOTTON1: { api: "IOTTON1" },
  IOTTON2: { api: "IOTTON2" },
  IORTOV1: { api: "IORTOV1" },
  IORSAR1: { api: "IORSAR1" },
  IOVADA9: { api: "IOVADA9" },
  IOVADA12: { api: "IOVADA12" },
  IPAVIA9: { api: "IPAVIA9" },
  IPAVIA24: { api: "IPAVIA24" },
  IPAVIA42: { api: "IPAVIA42" },
  IPEVER4: { api: "IPEVER4" },
  IPIEA6: { api: "IPIEA6" },
  IPIEMONT238: { api: "IPIEMONT238" },
  IPIETR8: { api: "IPIETR8" },
  IPIEVE47: { api: "IPIEVE47" },
  IPOIRI2: { api: "IPOIRI2" },
  IPONZO6: { api: "IPONZO6" },
  IPONZO9: { api: "IPONZO9" },
  IPMVILLA8: { api: "IPMVILLA8" },
  IPRASC3: { api: "IPRASC3" },
  IRAPAL8: { api: "IRAPAL8" },
  IRAPAL15: { api: "IRAPAL15" },
  IRAPAL26: { api: "IRAPAL26" },
  IRAPAL29: { api: "IRAPAL29" },
  IRAPAL33: { api: "IRAPAL33" },
  IRIALT2: { api: "IRIALT2" },
  IRICCD2: { api: "IRICCD2" },
  IRIVAP3: { api: "IRIVAP3" },
  IROATT2: { api: "IROATT2" },
  IROCCA35: { api: "IROCCA35" },
  IROCCA37: { api: "IROCCA37" },
  IROCCA49: { api: "IROCCA49" },
  IROCCA172: { api: "IROCCA172" },
  IRODEL3: { api: "IRODEL3" },
  IRODDI4: { api: "IRODDI4" },
  IRONCO16: { api: "IRONCO16" },
  IRONCO23: { api: "IRONCO23" },
  IRONCO30: { api: "IRONCO30" },
  IROSSI9: { api: "IROSSI9" },
  IROVEG2: { api: "IROVEG2" },
  ISANBE44: { api: "ISANBE44" },
  ISANCR61: { api: "ISANCR61" },
  ISANDA4: { api: "ISANDA4" },
  ISANDA45: { api: "ISANDA45" },
  ISANFR79: { api: "ISANFR79" },
  ISANGI194: { api: "ISANGI194" },
  ISANMA94: { api: "ISANMA94" },
  ISANPA4: { api: "ISANPA4" },
  ISANRE10: { api: "ISANRE10" },
  ISANRE25: { api: "ISANRE25" },
  ISANRE52: { api: "ISANRE52" },
  ISANTA737: { api: "ISANTA737" },
  ISANTA1095: { api: "ISANTA1095" },
  ISANTA1316: { api: "ISANTA1316" },
  ISANTA1419: { api: "ISANTA1419" },
  ISANTA1669: { api: "ISANTA1669" },
  ISANTE63: { api: "ISANTE63" },
  ISANTO233: { api: "ISANTO233" },
  ISANTO347: { api: "ISANTO347" },
  ISANTO411: { api: "ISANTO411" },
  ISARZA7: { api: "ISARZA7" },
  ISARZA25: { api: "ISARZA25" },
  ISAVIG25: { api: "ISAVIG25" },
  ISAVIG93: { api: "ISAVIG93" },
  ISAVON38: { api: "ISAVON38" },
  ISAVONA11: { api: "ISAVONA11" },
  ISAVONAL1: { api: "ISAVONAL1" },
  ISESSA22: { api: "ISESSA22" },
  ISESTR23: { api: "ISESTR23" },
  ISESTR28: { api: "ISESTR28" },
  ISESTR36: { api: "ISESTR36" },
  ISERRA21: { api: "ISERRA21" },
  ISERRA22: { api: "ISERRA22" },
  ISERRA75: { api: "ISERRA75" },
  ISERRA86: { api: "ISERRA86" },
  ISERRA88: { api: "ISERRA88" },
  ISILVA16: { api: "ISILVA16" },
  ISORI12: { api: "ISORI12" },
  ISPINE11: { api: "ISPINE11" },
  ISPIGN2: { api: "ISPIGN2" },
  ISPOTO4: { api: "ISPOTO4" },
  ISTAZZAN2: { api: "ISTAZZAN2" },
  ISTAZZ9: { api: "ISTAZZ9" },
  ISTAZZ13: { api: "ISTAZZ13" },
  ISTELL21: { api: "ISTELL21" },
  ITASSA1: { api: "ITASSA1" },
  ITESTI1: { api: "ITESTI1" },
  ITOSCANA56: { api: "ITOSCANA56" },
  ITOSCANA135: { api: "ITOSCANA135" },
  ITORRE444: { api: "ITORRE444" },
  ITORRI4: { api: "ITORRI4" },
  ITORRI20: { api: "ITORRI20" },
  ITORRI54: { api: "ITORRI54" },
  ITORTO104: { api: "ITORTO104" },
  ITRIBO2: { api: "ITRIBO2" },
  IURBE3: { api: "IURBE3" },
  IURBE10: { api: "IURBE10" },
  IVADOL4: { api: "IVADOL4" },
  IVALBR3: { api: "IVALBR3" },
  IVALBR4: { api: "IVALBR4" },
  IVALDI75: { api: "IVALDI75" },
  IVALLE94: { api: "IVALLE94" },
  IVARAZ2: { api: "IVARAZ2" },
  IVARAZ6: { api: "IVARAZ6" },
  IVARAZ9: { api: "IVARAZ9" },
  IVARZI7: { api: "IVARZI7" },
  IVENTI16: { api: "IVENTI16" },
  IVERNA8: { api: "IVERNA8" },
  IVERRU5: { api: "IVERRU5" },
  IVEZZI1_: { api: "IVEZZI1" },
  IVIARE23: { api: "IVIARE23" },
  IVILLA352: { api: "IVILLA352" },
  IVILLA764: { api: "IVILLA764" },
  IVILLA1061: { api: "IVILLA1061" },
  IVILLA1125: { api: "IVILLA1125" },
  IVILLA1686: { api: "IVILLA1686" },
  IVILLA1819: { api: "IVILLA1819" },
  IVOGHE6: { api: "IVOGHE6" },
  IVOLTA3: { api: "IVOLTA3" },
  IVOLTA7: { api: "IVOLTA7" },
  IZIGNA2: { api: "IZIGNA2" },
  ILALOG2: { api: "ILALOG2" },
  ITROFA24: { api: "ITROFA24" },
  ITONICHE1: { api: "ITONICHE1" },
  IVOLVE3: { api: "IVOLVE3" },
  IVIGON12: { api: "IVIGON12" },
  IVIRLE1: { api: "IVIRLE1" },
  IGENOA3101: { api: "IGENOA3101" },
  IGENOA2763: { api: "IGENOA2763" },
  ILIGURIA67: { api: "ILIGURIA67" },
  IZUCCA2: { api: "IZUCCA2" },
  ICARRO18: { api: "ICARRO18" },
  IBORGH19: { api: "IBORGH19" },
  IRICCD1: { api: "IRICCD1" },
  ILASPE54: { api: "ILASPE54" },
  IPODEN7: { api: "IPODEN7" },
  IBOLAN4: { api: "IBOLAN4" },
  IAULLA13: { api: "IAULLA13" },
  ISANTO122: { api: "ISANTO122" },
  ISESTR27: { api: "ISESTR27" },
  ICHIAV18: { api: "ICHIAV18" },
  ILAVAG25: { api: "ILAVAG25" },
  ILAVAG28: { api: "ILAVAG28" },
  IPISA68: { api: "IPISA68" },
  ILIVOR77: { api: "ILIVOR77" },
  ILIVOR44: { api: "ILIVOR44" },
  IROSIG33: { api: "IROSIG33" },
  IROSIG55: { api: "IROSIG55" },
  ICASTE621: { api: "ICASTE621" },
  ICASTA86: { api: "ICASTA86" },
  IPIOMB27: { api: "IPIOMB27" },
  IPIOMB32: { api: "IPIOMB32" },
  ICAMPI72: { api: "ICAMPI72" },
  IPIOMB19: { api: "IPIOMB19" },
  IPORTO350: { api: "IPORTO350" },
  ICAMPO382: { api: "ICAMPO382" },
  IPIETR31: { api: "IPIETR31" },
  IFORTE35: { api: "IFORTE35" },
  ICAMAI18: { api: "ICAMAI18" },
  IVIARE22: { api: "IVIARE22" },
  IPISA55: { api: "IPISA55" },
  IPISA66: { api: "IPISA66" },
  ICASCI45: { api: "ICASCI45" },
  ILIVOR90: { api: "ILIVOR90" },
  ILIVOR65: { api: "ILIVOR65" },
  IFAUGLIA5: { api: "IFAUGLIA5" },
  ICAMAI23: { api: "ICAMAI23" },
  IPESCA65: { api: "IPESCA65" },
  IPESCA30: { api: "IPESCA30" },
  IBORGO8: { api: "IBORGO8" },
  IBARGA6: { api: "IBARGA6" },
  IBARGA21: { api: "IBARGA21" },
  IGALLI34: { api: "IGALLI34" },
  ISCARLIN2: { api: "ISCARLIN2" },
  ICASTI181: { api: "ICASTI181" },
  IGROSS76: { api: "IGROSS76" },
  IGROSS24: { api: "IGROSS24" },
  IGROSS49: { api: "IGROSS49" },
  IGROSS81: { api: "IGROSS81" },
  IGROSS79: { api: "IGROSS79" },
  IMAGLI36: { api: "IMAGLI36" },
  ICASTI124: { api: "ICASTI124" },
  IGAVOR3: { api: "IGAVOR3" },
  ITOSCANA114: { api: "ITOSCANA114" },
  ICAMPA38: { api: "ICAMPA38" },
  IBAGNA36: { api: "IBAGNA36" },
  ISCAGN2: { api: "ISCAGN2" },
  IVICOF8: { api: "IVICOF8" },
  IVICOF5: { api: "IVICOF5" },
  IROCCA98: { api: "IROCCA98" },
  IROCCA101: { api: "IROCCA101" },
  IROCCA9: { api: "IROCCA9" },
  IDEMON2: { api: "IDEMON2" },
  IBORGO63: { api: "IBORGO63" },
  IVIGNO11: { api: "IVIGNO11" },
  ICUNEO23: { api: "ICUNEO23" },
  ICUNEO15: { api: "ICUNEO15" },
  IVALGR2: { api: "IVALGR2" },
  IBERNE82: { api: "IBERNE82" },
  ICERVA10: { api: "ICERVA10" },
  ICERVA15: { api: "ICERVA15" },
  ICARAG5: { api: "ICARAG5" },
  IDRONE3: { api: "IDRONE3" },
  IDRONE2: { api: "IDRONE2" },
  IDRONE4: { api: "IDRONE4" },
  IROCCA71: { api: "IROCCA71" },
  IVILLA505: { api: "IVILLA505" },
  IVILLA924: { api: "IVILLA924" },
  IBUSCA8: { api: "IBUSCA8" },
  IPIASC1: { api: "IPIASC1" },
  IRIFRE2: { api: "IRIFRE2" },
  IENVIE3: { api: "IENVIE3" },
  IREVEL60: { api: "IREVEL60" },
  IPRALI4: { api: "IPRALI4" },
  IFENES3: { api: "IFENES3" },
  IROURE1: { api: "IROURE1" },
  IPERRE12: { api: "IPERRE12" },
  IPEROS1: { api: "IPEROS1" },
  IPMPONTE5: { api: "IPMPONTE5" },
  ICHIOM4: { api: "ICHIOM4" },
  IBARDO23: { api: "IBARDO23" },
  IBARDO27: { api: "IBARDO27" },
  IBARDO16: { api: "IBARDO16" },
  IOULX4: { api: "IOULX4" },
  IOULX5: { api: "IOULX5" },
  ISALBE1: { api: "ISALBE1" },
  IGIAGL1: { api: "IGIAGL1" },
  INOVAL8: { api: "INOVAL8" },
  IMONCENI2: { api: "IMONCENI2" },
  IMOMPA3: { api: "IMOMPA3" },
  IMOMPANT2: { api: "IMOMPANT2" },
  IMATTI3: { api: "IMATTI3" },
  IBUSSO14: { api: "IBUSSO14" },
  IBUSSO5: { api: "IBUSSO5" },
  ICHIAN5: { api: "ICHIAN5" },
  IBRUZO2: { api: "IBRUZO2" },
  ISANGI141: { api: "ISANGI141" },
  ICONDO30: { api: "ICONDO30" },
  IVILLA1146: { api: "IVILLA1146" },
  IVILLA220: { api: "IVILLA220" },
  IVILLA774: { api: "IVILLA774" },
  ISANTA993: { api: "ISANTA993" },
  ICONDO19: { api: "ICONDO19" },
  ICONDO26: { api: "ICONDO26" },
  ISANTA614: { api: "ISANTA614" },
  ILUINO13: { api: "ILUINO13" },
  IDUMEN2: { api: "IDUMEN2" },
  ILUINO15: { api: "ILUINO15" },
  ILUINO6: { api: "ILUINO6" },
  IBREZZ4: { api: "IBREZZ4" },
  ILAVEN14: { api: "ILAVEN14" },
  IMESEN3: { api: "IMESEN3" },
  ICASSA35: { api: "ICASSA35" },
  ITAMBR10: { api: "ITAMBR10" },
  IPRAMO8: { api: "IPRAMO8" },
  IPINAS3: { api: "IPINAS3" },
  IPINAS5: { api: "IPINAS5" },
  IVILLA1673: { api: "IVILLA1673" },
  IPIEMONT258: { api: "IPIEMONT258" },
  IPRARO1: { api: "IPRARO1" },
  IPINER91: { api: "IPINER91" },
  IPINER30: { api: "IPINER30" },
  ISANPI32: { api: "ISANPI32" },
  ITORINOP2: { api: "ITORINOP2" },
  IPINER90: { api: "IPINER90" },
  IPINER67: { api: "IPINER67" },
  IPINEROL19: { api: "IPINEROL19" },
  IBURIA1: { api: "IBURIA1" },
  IFROSS1: { api: "IFROSS1" },
  IPISCI4: { api: "IPISCI4" },
  IVOLVE4: { api: "IVOLVE4" },
  ICAVOU1: { api: "ICAVOU1" },
  IBIRCH9: { api: "IBIRCH9" },
  IVILLARP8: { api: "IVILLARP8" },
  ITORREPE3: { api: "ITORREPE3" },
  IANGRO6: { api: "IANGRO6" },
  IROR3: { api: "IROR3" },
  IBARGE18: { api: "IBARGE18" },
  IBAGNO63: { api: "IBAGNO63" },
  IBIBIA2: { api: "IBIBIA2" },
  IENVIE4: { api: "IENVIE4" },
  ISCARN3: { api: "ISCARN3" },
  IPIOSS5: { api: "IPIOSS5" },
  IRIVAL15: { api: "IRIVAL15" },
  ITRANA3: { api: "ITRANA3" },
  IGIAVE3: { api: "IGIAVE3" },
  IPMGIAVE6: { api: "IPMGIAVE6" },
  ICOAZZ6: { api: "ICOAZZ6" },
  ICOAZZ4: { api: "ICOAZZ4" },
  IAVIGL6: { api: "IAVIGL6" },
  IRIVAL6: { api: "IRIVAL6" },
  IRIVOL16: { api: "IRIVOL16" },
  IALMES4: { api: "IALMES4" },
  IROSTA7: { api: "IROSTA7" },
  ICOLLE151: { api: "ICOLLE151" },
  IGIVOL2: { api: "IGIVOL2" },
  ILACAS8: { api: "ILACAS8" },
  IVENAR2: { api: "IVENAR2" },
  INOLE6: { api: "INOLE6" },
  IVALLO8: { api: "IVALLO8" },
  IBALAN8: { api: "IBALAN8" },
  ICORIO4: { api: "ICORIO4" },
  IGERMA4: { api: "IGERMA4" },
  ICANTO12: { api: "ICANTO12" },
  ICERES14: { api: "ICERES14" },
  IALADI3: { api: "IALADI3" },
  IALADI1: { api: "IALADI1" },
  IRHMES1: { api: "IRHMES1" },
  ICOURM10: { api: "ICOURM10" },
  ICOURM3: { api: "ICOURM3" },
  IOLLOM2: { api: "IOLLOM2" },
  IVALTO2: { api: "IVALTO2" },
  IBORGO131: { api: "IBORGO131" },
  IEMILIAR181: { api: "IEMILIAR181" },
  IPALAN9: { api: "IPALAN9" },
  IFARIN10: { api: "IFARIN10" },
  IBETTO1: { api: "IBETTO1" },
  IBETTO20: { api: "IBETTO20" },
  ITRAVO6: { api: "ITRAVO6" },
  IROMAG9: { api: "IROMAG9" },
  IZAVAT1: { api: "IZAVAT1" },
  IALTAV16: { api: "IALTAV16" },
  IGOLFE1: { api: "IGOLFE1" },
  ICASTA79: { api: "ICASTA79" },
  ISTRADADEL11: { api: "ISTRADADEL11" },
  IBORGO59: { api: "IBORGO59" },
  ICAMBI25: { api: "ICAMBI25" },
  IMONCA21: { api: "IMONCA21" },
  IPINOT4: { api: "IPINOT4" },
  ICHIER3: { api: "ICHIER3" },
  IBALDI142: { api: "IBALDI142" },
  IARIGN3: { api: "IARIGN3" },
  ISANMA95: { api: "ISANMA95" },
  ISCIOL3: { api: "ISCIOL3" },
  IRIVALBA2: { api: "IRIVALBA2" },
  ISETTI13: { api: "ISETTI13" },
  IBORGA47: { api: "IBORGA47" },
  ILEINI4: { api: "ILEINI4" },
  IVOLPI4: { api: "IVOLPI4" },
  ISANFR59: { api: "ISANFR59" },
  ICORIO8: { api: "ICORIO8" },
  IPIEMONT87: { api: "IPIEMONT87" },
  ICUORG4: { api: "ICUORG4" },
  IRIVAR15: { api: "IRIVAR15" },
  IFAVRI2: { api: "IFAVRI2" },
  ISANGI197: { api: "ISANGI197" },
  ICUCEG2: { api: "ICUCEG2" },
  ILORAN1: { api: "ILORAN1" },
  IPIEMONT121: { api: "IPIEMONT121" },
  IIVREA9: { api: "IIVREA9" },
  ITOSETTI2: { api: "ITOSETTI2" },
  IBROSS5: { api: "IBROSS5" },
  IPIEMONT169: { api: "IPIEMONT169" },
  IPONTS3: { api: "IPONTS3" },
  IPERLO3: { api: "IPERLO3" },
  IVALLEDA4: { api: "IVALLEDA4" },
  IGRESS20: { api: "IGRESS20" },
  ICHAMP172: { api: "ICHAMP172" },
  IMONTJ17: { api: "IMONTJ17" },
  IMONTJOV2: { api: "IMONTJOV2" },
  ISAINT4791: { api: "ISAINT4791" },
  IAYAS5: { api: "IAYAS5" },
  IAYAS13: { api: "IAYAS13" },
  ICHTIL24: { api: "ICHTIL24" },
  IAOSTACH2: { api: "IAOSTACH2" },
  IANTEY1: { api: "IANTEY1" },
  ITORGN6: { api: "ITORGN6" },
  IANTEY3: { api: "IANTEY3" },
  ICHAMO9: { api: "ICHAMO9" },
  IVALTO7: { api: "IVALTO7" },
  ICHAMB79: { api: "ICHAMB79" },
  IVERRA2: { api: "IVERRA2" },
  IVALLEDA19: { api: "IVALLEDA19" },
  ISAINT482: { api: "ISAINT482" },
  IPROVI59: { api: "IPROVI59" },
  IGRESS24: { api: "IGRESS24" },
  ISARRE7: { api: "ISARRE7" },
  ICHARV6: { api: "ICHARV6" },
  ICHARV4: { api: "ICHARV4" },
  IGRESS6: { api: "IGRESS6" },
  ISAINT8985: { api: "ISAINT8985" },
  IMORGE4: { api: "IMORGE4" },
  ILATHU2: { api: "ILATHU2" },
  ILATHU10: { api: "ILATHU10" },
  ICOURM3: { api: "ICOURM3" },
  IINTRO3: { api: "IINTRO3" },
  IDONAT4: { api: "IDONAT4" },
  INETRO2: { api: "INETRO2" },
  IZUBIE1: { api: "IZUBIE1" },
  IMONGR1: { api: "IMONGR1" },
  IDONAT3: { api: "IDONAT3" },
  IDONAT6: { api: "IDONAT6" },
  ISALUS1: { api: "ISALUS1" },
  ISORDEVO2: { api: "ISORDEVO2" },
  IPOLLO1: { api: "IPOLLO1" },
  IBIELL11: { api: "IBIELL11" },
  IBIELL8: { api: "IBIELL8" },
  IPIEMONT126: { api: "IPIEMONT126" },
  ICAMPI93: { api: "ICAMPI93" },
  ITAVIG7: { api: "ITAVIG7" },
  IBIOGL1: { api: "IBIOGL1" },
  IBIOGL2: { api: "IBIOGL2" },
  IVALDI62: { api: "IVALDI62" },
  IPORTU23: { api: "IPORTU23" },
  ICURIN10: { api: "ICURIN10" },
  ICURIN9: { api: "ICURIN9" },
  ISOSTE1: { api: "ISOSTE1" },
  ILOZZOLO2: { api: "ILOZZOLO2" },
  IGATTINA2: { api: "IGATTINA2" },
  IROMAG19: { api: "IROMAG19" },
  IBORGO135: { api: "IBORGO135" },
  IBORGO29: { api: "IBORGO29" },
  IVARAL2: { api: "IVARAL2" },
  ISCOPA3: { api: "ISCOPA3" },
  IPIEMONT250: { api: "IPIEMONT250" },
  IPIEMONT251: { api: "IPIEMONT251" },
  IALAGN11: { api: "IALAGN11" },
  IALAGN5: { api: "IALAGN5" },
  IBORGO17: { api: "IBORGO17" },
  ICUREG3: { api: "ICUREG3" },
  IGOZZA3: { api: "IGOZZA3" },
  IPOGNO1: { api: "IPOGNO1" },
  IAROLA5: { api: "IAROLA5" },
  IOMEGN5: { api: "IOMEGN5" },
  IPETTE12: { api: "IPETTE12" },
  IARMEN5: { api: "IARMEN5" },
  IVALST3: { api: "IVALST3" },
  IGRAVE48: { api: "IGRAVE48" },
  IPREMO5: { api: "IPREMO5" },
  IPIEDI10: { api: "IPIEDI10" },
  IBANNI6: { api: "IBANNI6" },
  IVILLA1613: { api: "IVILLA1613" },
  IDOMOD11: { api: "IDOMOD11" },
  ICREVO4: { api: "ICREVO4" },
  IDOMOD18: { api: "IDOMOD18" },
  ITOCEN1: { api: "ITOCEN1" },
  IMALES2: { api: "IMALES2" },
  IVARZO3: { api: "IVARZO3" },
  IVARZO2: { api: "IVARZO2" },
  IFORMA3: { api: "IFORMA3" },
  ICAMBI27: { api: "ICAMBI27" },
  IVERBA25: { api: "IVERBA25" },
  IVERBA24: { api: "IVERBA24" },
  IOGGEB4: { api: "IOGGEB4" },
  ICANNO4: { api: "ICANNO4" },
  ICANNO18: { api: "ICANNO18" },
  IMACCA15: { api: "IMACCA15" },
  ICALUS9: { api: "ICALUS9" },
  IVISCH1: { api: "IVISCH1" },
  IMERCE2: { api: "IMERCE2" },
  IROPPO1: { api: "IROPPO1" },
  IPIVER4: { api: "IPIVER4" },
  ISANDI20: { api: "ISANDI20" },
  ICANDE45: { api: "ICANDE45" },
  IGIFFLEN2: { api: "IGIFFLEN2" },
  ICOSSA55: { api: "ICOSSA55" },
  ICARPI27: { api: "ICARPI27" },
  IGHEMM1: { api: "IGHEMM1" },
  IBAREN12: { api: "IBAREN12" },
  IBAVEN2: { api: "IBAVEN2" },
  ISTRES7: { api: "ISTRES7" },
  IBROVE3: { api: "IBROVE3" },
  IBELGI1: { api: "IBELGI1" },
  ILESA28: { api: "ILESA28" },
  INEBBI2: { api: "INEBBI2" },
  IOLEGG6: { api: "IOLEGG6" },
  ICOMIG1: { api: "ICOMIG1" },
  IPIEMONT132: { api: "IPIEMONT132" },
  IBORGO80: { api: "IBORGO80" },
  ICUREG4: { api: "ICUREG4" },
  IGARGA19: { api: "IGARGA19" },
  IBORGO108: { api: "IBORGO108" },
  IAGRAT15: { api: "IAGRAT15" },
  IAGRAT13: { api: "IAGRAT13" },
  IMEZZO14: { api: "IMEZZO14" },
  IVAPRI6: { api: "IVAPRI6" },
  ICALTIGN3: { api: "ICALTIGN3" },
  ICASAL31: { api: "ICASAL31" },
  ISANPI40: { api: "ISANPI40" },
  ICAMER16: { api: "ICAMER16" },
  IGALLI7: { api: "IGALLI7" },
  ITRECA15: { api: "ITRECA15" },
  IGALLI10: { api: "IGALLI10" },
  IBERNATE2: { api: "IBERNATE2" },
  ICASTA3: { api: "ICASTA3" },
  ILONAT3: { api: "ILONAT3" },
  ILOMBARD227: { api: "ILOMBARD227" },
  IMEZZO16: { api: "IMEZZO16" },
  IBELLINZ47: { api: "IBELLINZ47" },
  IGALLA20: { api: "IGALLA20" },
  IGALLA28: { api: "IGALLA28" },
  ICASSA30: { api: "ICASSA30" },
  IVARESEC3: { api: "IVARESEC3" },
  IBESNA2: { api: "IBESNA2" },
  IBESNA3: { api: "IBESNA3" },
  IVERGI8: { api: "IVERGI8" },
  IPIEMONT69: { api: "IPIEMONT69" },
  ISESTO12: { api: "ISESTO12" },
  ISESTO36: { api: "ISESTO36" },
  ILAMBRUSC2: { api: "ILAMBRUSC2" },
  ITAINO2: { api: "ITAINO2" },
  IANGER73: { api: "IANGER73" },
  IISPRA10: { api: "IISPRA10" },
  IISPRA7: { api: "IISPRA7" },
  ITRAVE36: { api: "ITRAVE36" },
  IMONVA3: { api: "IMONVA3" },
  IBESOZ4: { api: "IBESOZ4" },
  IVARESEB1: { api: "IVARESEB1" },
  IBESOZ3: { api: "IBESOZ3" },
  ILOMBARD79: { api: "ILOMBARD79" },
  IGEMON12: { api: "IGEMON12" },
  ILAVEN7: { api: "ILAVEN7" },
  ILAVEN16: { api: "ILAVEN16" },
  ILEGGI2: { api: "ILEGGI2" },
  ILAVENOM13: { api: "ILAVENOM13" },
  ICASTE362: { api: "ICASTE362" },
  ICASTE1092: { api: "ICASTE1092" },
  ICITTI1: { api: "ICITTI1" },
  ICASAL54: { api: "ICASAL54" },
  IAZZIO1: { api: "IAZZIO1" },
  ICASTE564: { api: "ICASTE564" },
  IPORTA205: { api: "IPORTA205" },
  IASTI24: { api: "IASTI24" },
  ICASTA37: { api: "ICASTA37" },
  ILU5: { api: "ILU5" },
  IFUBIN1: { api: "IFUBIN1" },
  IALTAV9: { api: "IALTAV9" },
  ICAMAG1: { api: "ICAMAG1" },
  IROSIG24: { api: "IROSIG24" },
  ISANGI186: { api: "ISANGI186" },
  ICASALEM1135: { api: "ICASALEM1135" },
  ICASAL17: { api: "ICASAL17" },
  ICASAL90: { api: "ICASAL90" },
  ISTROPPI2: { api: "ISTROPPI2" },
  IASIGL1: { api: "IASIGL1" },
  IVERCE2: { api: "IVERCE2" },
  ICASALIN2: { api: "ICASALIN2" },
  ICONFI7: { api: "ICONFI7" },
  ICASAL38: { api: "ICASAL38" },
  ISANPI34: { api: "ISANPI34" },
  INOVAR29: { api: "INOVAR29" },
  INOVAR9: { api: "INOVAR9" },
  INOVAR10: { api: "INOVAR10" },
  INOVAR19: { api: "INOVAR19" },
  ITERDO1: { api: "ITERDO1" },
  IROBBI2: { api: "IROBBI2" },
  IBORGO18: { api: "IBORGO18" },
  ICILAV1: { api: "ICILAV1" },
  IMORTA17: { api: "IMORTA17" },
  ICASTE892: { api: "ICASTE892" },
  IPORTA126: { api: "IPORTA126" },
  ICALLI82: { api: "ICALLI82" },
  IPONZA11: { api: "IPONZA11" },
  IOTTIG17: { api: "IOTTIG17" },
  IGRAZZ4: { api: "IGRAZZ4" },
  ICALLIAN12: { api: "ICALLIAN12" },
  ICALLI66: { api: "ICALLI66" },
  ICASTE729: { api: "ICASTE729" },
  ICAMER10: { api: "ICAMER10" },
  IPIEMONT58: { api: "IPIEMONT58" },
  IMONTI121: { api: "IMONTI121" },
  ISOLON8: { api: "ISOLON8" },
  ISOLON1: { api: "ISOLON1" },
  IVILLA493: { api: "IVILLA493" },
  IPROZO1: { api: "IPROZO1" },
  IFONTA121: { api: "IFONTA121" },
  ITONEN1: { api: "ITONEN1" },
  ITORINOC5: { api: "ITORINOC5" },
  IARAME1: { api: "IARAME1" },
  ICASAL41: { api: "ICASAL41" },
  IVEROL7: { api: "IVEROL7" },
  ITORRA3: { api: "ITORRA3" },
  ICALUS1: { api: "ICALUS1" },
  ICHIVASS5: { api: "ICHIVASS5" },
  IRIVAL17: { api: "IRIVAL17" },
  ISCIOL2: { api: "ISCIOL2" },
  IGASSI7: { api: "IGASSI7" },
  ITURIN3182: { api: "ITURIN3182" },
  ITURIN3229: { api: "ITURIN3229" },
  ITURIN3198: { api: "ITURIN3198" },
  ITURIN3249: { api: "ITURIN3249" },
  ITURIN3193: { api: "ITURIN3193" },
  ITURIN3250: { api: "ITURIN3250" },
  ITURIN3266: { api: "ITURIN3266" },
  ITURIN3170: { api: "ITURIN3170" },
  ITURIN3276: { api: "ITURIN3276" },
  IBRUSI2: { api: "IBRUSI2" },
  IBRUSI1: { api: "IBRUSI1" },
  ICUASS1: { api: "ICUASS1" },
  IVARESEC5: { api: "IVARESEC5" },
  IBESAN18: { api: "IBESAN18" },
  ISALTR6: { api: "ISALTR6" },
  IVIGGI18: { api: "IVIGGI18" },
  IARCIS6: { api: "IARCIS6" },
  IINDUNOO6: { api: "IINDUNOO6" },
  IRONAG1: { api: "IRONAG1" },
  IUGGIA3: { api: "IUGGIA3" },
  IALBIO2: { api: "IALBIO2" },
  ISOLBI5: { api: "ISOLBI5" },
  IBINAG2: { api: "IBINAG2" },
  IVEDAN5: { api: "IVEDAN5" },
  ISANFE100: { api: "ISANFE100" },
  ICOMO54: { api: "ICOMO54" },
  IMASLI2: { api: "IMASLI2" },
  ICERNOBB13: { api: "ICERNOBB13" },
  ILOMBARD377: { api: "ILOMBARD377" },
  IMOLTR2: { api: "IMOLTR2" },
  ILAGLI2: { api: "ILAGLI2" },
  IDIZZA8: { api: "IDIZZA8" },
  ICENTR750: { api: "ICENTR750" },
  ICENTR787: { api: "ICENTR787" },
  IPONNA1: { api: "IPONNA1" },
  IALTAV22: { api: "IALTAV22" },
  IALTAV30: { api: "IALTAV30" },
  IALTAV17: { api: "IALTAV17" },
  IALTAV10: { api: "IALTAV10" },
  ISALAC11: { api: "ISALAC11" },
  IMENAG2: { api: "IMENAG2" },
  IPORLE1: { api: "IPORLE1" },
  ICARLA10: { api: "ICARLA10" },
  ISANSI5: { api: "ISANSI5" },
  ICREMI6: { api: "ICREMI6" },
  IPIANE12: { api: "IPIANE12" },
  IGERAL122: { api: "IGERAL122" },
  IGERAL99: { api: "IGERAL99" },
  ISORIC2: { api: "ISORIC2" },
  ISORIC4: { api: "ISORIC4" },
  IDUBIN6: { api: "IDUBIN6" },
  ISORIC5: { api: "ISORIC5" },
  INOVAT8: { api: "INOVAT8" },
  INOVAT10: { api: "INOVAT10" },
  IMESE3: { api: "IMESE3" },
  ISANGI202: { api: "ISANGI202" },
  ICAMPO129: { api: "ICAMPO129" },
  IVILLA1237: { api: "IVILLA1237" },
  IDELEB2: { api: "IDELEB2" },
  ITRAON2: { api: "ITRAON2" },
  IMELLO1: { api: "IMELLO1" },
  IARDEN33: { api: "IARDEN33" },
  IVALMASI2: { api: "IVALMASI2" },
  ICASTI120: { api: "ICASTI120" },
  ICAIOL2: { api: "ICAIOL2" },
  IOBJECTH4: { api: "IOBJECTH4" },
  ISONDR8: { api: "ISONDR8" },
  IMONTA244: { api: "IMONTA244" },
  IPIATEDA2: { api: "IPIATEDA2" },
  IPIATE4: { api: "IPIATE4" },
  ILANZA7: { api: "ILANZA7" },
  ILANZA6: { api: "ILANZA6" },
  ICHIUR7: { api: "ICHIUR7" },
  ITEGLI5: { api: "ITEGLI5" },
  ITEGLI6: { api: "ITEGLI6" },
  IBIANZ2: { api: "IBIANZ2" },
  IAPRIC10: { api: "IAPRIC10" },
  ISOTIRAN3: { api: "ISOTIRAN3" },
  ITIRANO3: { api: "ITIRANO3" },
  IVILLA996: { api: "IVILLA996" },
  ITIRAN7: { api: "ITIRAN7" },
  ISERNI3: { api: "ISERNI3" },
  ITOVOD1: { api: "ITOVOD1" },
  IVERVI23: { api: "IVERVI23" },
  IMONNO1: { api: "IMONNO1" },
  IGROSO6: { api: "IGROSO6" },
  IGROSI31: { api: "IGROSI31" },
  IGROSI38: { api: "IGROSI38" },
  ISONDA1: { api: "ISONDA1" },
  ISONDA4: { api: "ISONDA4" },
  ILOMBARD436: { api: "ILOMBARD436" },
  ILOMBARD331: { api: "ILOMBARD331" },
  IVALDI93: { api: "IVALDI93" },
  IVALDI41: { api: "IVALDI41" },
  IVALDI61: { api: "IVALDI61" },
  ILIVIG1: { api: "ILIVIG1" },
  IEDOLO3: { api: "IEDOLO3" },
  ITEM2: { api: "ITEM2" },
  IVIONE1: { api: "IVIONE1" },
  IPONTE22: { api: "IPONTE22" },
  IPONTE56: { api: "IPONTE56" },
  IPONTE101: { api: "IPONTE101" },
  IVERMI19: { api: "IVERMI19" },
  
};
const stationsLimet = {
  Molassana: {
    link: "molassana-alta", // parte variabile della URL
    link2: "terzereti",
    lat: 44.461,            // latitudine
    lon: 8.987              // longitudine
  },
  Fabbriche: {
    link: "fabbriche-brusinetti", // parte variabile della URL
    link2: "meteo-fabbriche-brusinetti",
    lat: 44.446,            // latitudine
    lon: 8.714              // longitudine
  },
  Pietralavezzara: {
    link: "pietralavezzara", // parte variabile della URL
    link2: "meteo-pietralavezzara",
    lat: 44.536,            // latitudine
    lon: 8.883              // longitudine
  },
  SantOlcese: {
    link: "solcese", // parte variabile della URL
    link2: "meteo-solcese",
    lat: 44.483,            // latitudine
    lon: 8.966             // longitudine
  },
  Foce: {
    link: "ldoria", // parte variabile della URL
    link2: "meteo-ldoria",
    lat: 44.401,            // latitudine
    lon: 8.942            // longitudine
  },
  Pontori: {
    link: "pontori", // parte variabile della URL
    link2: "meteo-pontori",
    lat: 44.367,            // latitudine
    lon: 9.435        // longitudine
  },
  Arenzano: {
    link: "arenzano-porto", // parte variabile della URL
    link2: "terzereti",
    lat: 44.400,            // latitudine
    lon: 8.687            // longitudine
  },
  WTC: {
    link: "wtc", // parte variabile della URL
    link2: "meteo-wtc",
    lat: 44.408,            // latitudine
    lon: 8.901              // longitudine
  },
  Sampierdarena: {
    link: "sampierdarena", // parte variabile della URL
    link2: "meteo-sampierdarena",
    lat: 44.416,            // latitudine
    lon: 8.886              // longitudine
  },
  Parazzuolo: {
    link: "parazzuolo", // parte variabile della URL
    link2: "meteo-parazzuolo",
    lat: 44.478,            // latitudine
    lon: 9.325             // longitudine
    
  },
  Montoggio: {
    link: "montoggio", // parte variabile della URL
    link2: "meteo-montoggio",
    lat: 44.517,            // latitudine
    lon: 9.050             // longitudine
    
  },
  SanRocco: {
    link: "sanrocco", // parte variabile della URL
    link2: "meteo-sanrocco",
    lat: 44.334,            // latitudine
    lon: 9.161             // longitudine
    
  },
  SantAlberto: {
    link: "salberto", // parte variabile della URL
    link2: "meteo-salberto",
    lat: 44.444,            // latitudine
    lon: 9.103             // longitudine
    
  },
  LagoLame: {
    link: "lame", // parte variabile della URL
    link2: "meteo-lame",
    lat: 44.503,            // latitudine
    lon: 9.408             // longitudine
    
  },
  Rezzoaglio: {
    link: "rezzoaglio", // parte variabile della URL
    link2: "meteo-rezzoaglio",
    lat: 44.525,            // latitudine
    lon: 9.385             // longitudine
    
  },
  RezzoaglioCerisola: {
    link: "rezzoaglio-cerisola", // parte variabile della URL
    link2: "meteo-rezzoaglio-cerisola",
    lat: 44.515,            // latitudine
    lon: 9.408             // longitudine
    
  },
  PuntaChiappa: {
    link: "batterie-pchiappa", // parte variabile della URL
    link2: "meteo-batterie-pchiappa",
    lat: 44.322,            // latitudine
    lon: 9.152             // longitudine
    
  },
  Ventarola: {
    link: "ventarola", // parte variabile della URL
    link2: "meteo-ventarola",
    lat: 44.555,            // latitudine
    lon: 9.305             // longitudine
    
  },
  ICBorzoli: {
    link: "borzoli", // parte variabile della URL
    link2: "meteo-borzoli",
    lat: 44.429,            // latitudine
    lon: 8.856             // longitudine
    
  },
  SantEusebio: {
    link: "eusebio", // parte variabile della URL
    link2: "meteo-eusebio",
    lat: 44.442,            // latitudine
    lon: 8.991             // longitudine
    
  },
  Fregarie: {
    link: "fregarie-scolombano", // parte variabile della URL
    link2: "meteo-fregarie-scolombano",
    lat: 44.380,            // latitudine
    lon: 9.305             // longitudine
    
  },
  Zoagli: {
    link: "zoagli-oliveto", // parte variabile della URL
    link2: "meteo-zoagli-oliveto",
    lat: 44.344,            // latitudine
    lon: 9.275             // longitudine
    
  },
  Moconesi: {
    link: "moconesi", // parte variabile della URL
    link2: "meteo-moconesi",
    lat: 44.424,            // latitudine
    lon: 9.190             // longitudine
    
  },
  SantaMaria: {
    link: "smaria", // parte variabile della URL
    link2: "meteo-smaria",
    lat: 44.358,            // latitudine
    lon: 9.186             // longitudine
    
  },
  Murlo: {
    link: "murlo", // parte variabile della URL
    link2: "meteo-murlo",
    lat: 44.055,            // latitudine
    lon: 9.956             // longitudine
    
  },
  Urbe: {
    link: "terzereti", // parte variabile della URL
    link2: "meteo-urbe-monta",
    lat: 44.489,            // latitudine
    lon: 8.581             // longitudine
    
  },
  UrbeSanPietro: {
    link: "urbe", // parte variabile della URL
    link2: "meteo-urbe",
    lat: 44.486,            // latitudine
    lon: 8.587             // longitudine
    
  },
  Tiglieto: {
    link: "tiglieto", // parte variabile della URL
    link2: "meteo-tiglieto",
    lat: 44.529,            // latitudine
    lon: 8.626             // longitudine
    
  },
  Giusvalla: {
    link: "giusvalla", // parte variabile della URL
    link2: "meteo-giusvalla",
    lat: 44.448,            // latitudine
    lon: 8.394             // longitudine
    
  },
  Casanova: {
    link: "casanova", // parte variabile della URL
    link2: "meteo-casanova",
    lat: 44.375,            // latitudine
    lon: 8.574             // longitudine
    
  },
  CelleLigure: {
    link: "celle", // parte variabile della URL
    link2: "meteo-celle",
    lat: 44.343,            // latitudine
    lon: 8.545             // longitudine
    
  },
    Oregina: {
    link: "oregina", // parte variabile della URL
    link2: "meteo-oregina",
    lat: 44.424,            // latitudine
    lon: 8.927             // longitudine
    
  },
  MarassiFirpo: {
    link: "terzereti", // parte variabile della URL
    link2: "meteo-marassi-firpo",
    lat: 44.415,            // latitudine
    lon: 8.950             // longitudine
    
  },
  Cornigliano: {
    link: "cornigliano", // parte variabile della URL
    link2: "meteo-cornigliano",
    lat: 44.415,            // latitudine
    lon: 8.873             // longitudine
    
  },
  TramontanaSurfVoltri: {
    link: "voltri", // parte variabile della URL
    link2: "meteo-voltri",
    lat: 44.427,            // latitudine
    lon: 8.757             // longitudine
    
  },
  Albisola: {
    link: "albisola", // parte variabile della URL
    link2: "meteo-albisola",
    lat: 44.326,            // latitudine
    lon: 8.501             // longitudine
    
  },
  SavonaNautico: {
    link: "savona", // parte variabile della URL
    link2: "meteo-savona",
    lat: 44.308,            // latitudine
    lon: 8.487             // longitudine
    
  },
  Zinola: {
    link: "savona-zinola", // parte variabile della URL
    link2: "meteo-savona-zinola",
    lat: 44.282,            // latitudine
    lon: 8.443             // longitudine
    
  },
};

const stations1 = {
  Favale: {
    link: "https://retelimet.centrometeoligure.it/stazioni/meteo-favale/data/wd/file/customclientraw.txt",
    lat: 44.453,
    lon: 9.260
  },
  
  // aggiungi qui altre stazioni Cumulus MX, ognuna con link/lat/lon
};
const stations3 = {
  Cogoleto: {
    link: "https://meteocogoleto.altervista.org/cumulus/websitedata.json?_=1755609287452",
    lat: 44.390,
    lon: 8.646
  },
  
  // aggiungi qui altre stazioni Cumulus MX, ognuna con link/lat/lon
};
const stations2 = {
  PoggioRovegno: {
    link: "https://www.turbolic.altervista.org/meteopoggio/cumulus/index.htm",
    lat: 44.570,
    lon: 9.279
  },
  // aggiungi qui altre stazioni Cumulus MX, ognuna con link/lat/lon
};
const stationsDMA =  {
  pontecurone: {lat: 44.941, lon: 8.918}, 
  dusino: {lat: 44.922, lon: 7.974},
  antola: {lat: 44.567, lon: 9.150},
  mongiardino: {lat: 44.633, lon: 9.064},
  rossiglione: {lat: 44.561, lon: 8.671},
  grognardo: {lat: 44.629, lon: 8.485},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
  lerma: {lat: 44.631, lon: 8.695},
  fraconalto: {lat: 44.618, lon: 8.608},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
  ovadaCoinova: {lat: 44.618, lon: 8.608},
};
    const markers = {};
    let latestData = {};

// ----- Colori Umidità -----
function getColorHum(hum) {
  if (hum >= 90.0) return "#0114F0"; 
  if (hum >= 80.0) return "#0060F0"; 
  if (hum >= 70.0) return "#00BDEF"; 
  if (hum >= 60.0) return "#21C2C5"; 
  if (hum >= 50.0) return "#21C573"; 
  if (hum >= 40.0) return "#3AA300"; 
  if (hum >= 30.0) return "#F0B800"; 
  if (hum >= 20.0) return "#F0CB00";
  if (hum >= 10.0) return "#F07D00";
  return "#F01E00"; 
}

// ----- Colori Pioggia -----
function getColorRain(rain) {
  if (rain >= 150.0) return "#843BEB"; 
  if (rain >= 100.0) return "#FF69B4";
  if (rain >= 50.0) return "#0038F0";
  if (rain >= 30.0) return "#4682B4"; 
  if (rain >= 20.0) return "#87CEEB";
  if (rain >= 10.0) return "#3AA300";
  if (rain >= 5.0) return "#006400";
  if (rain >= 0.2) return "#F09F00";
  return "#808080"; 
}

// ----- Colori Temperatura -----
function getColorTemp(temp) {
  if (temp >= 38.0) return "#843BEB";
  if (temp >= 35.0) return "#FF69B4";
  if (temp >= 30.0) return "#8B0000";
  if (temp >= 25.0) return "#FF0000";
  if (temp >= 20.0) return "#E67D00";
  if (temp >= 15.0) return "#E6B800";
  if (temp >= 11.0) return "#3AA300";
  if (temp >= 5.0) return "#006400";
  if (temp >= 0.0) return "#87CEEB";
  if (temp >= -5.0) return "#4682B4";
  if (temp >= -10.0) return "#0000FF";
  return "#191970";
}
function getColorWindDir(wind) {
  if (WindDir >= 0) return "#4682B4";
  return "#191970";
}

// ----- Creazione Marker Responsivo -----
function createMarker(id, lat = 44.423, lon = 8.972) {
  const isMainMarker = lat === 44.423 && lon === 8.972;

  // scala tra 0.5 (mobile) e 1 (desktop)
  const scale = Math.min(window.innerWidth / 1200, 1);
  const baseSize = 40;
  const size = isMainMarker ? 0 : baseSize * scale;

  const fontSize = Math.max(12, 16 * scale); // font minimo 12px

  const icon = L.divIcon({
    className: '',
    html: `<div class="circle-label2"
                 style="
                   width: 0px;
                   height: 0px;
                   line-height: ${size}px;
                   border-radius: 50%;
                   background-color: #808080;
                   text-align: center;
                   color: white;
                   font-weight: bold;
                   font-size: 0px;
                 ">
           ${isMainMarker ? '' : id}
           </div>`,
    iconSize: [size, size],
    iconAnchor: [size / 2, size / 2]
  });

  const marker = L.marker([lat, lon], { icon }).addTo(map);

  const popupFont = Math.max(12, 14 * scale);
  marker.bindPopup(`<b style="font-size:${popupFont}px">Stazione:</b> ${id}<br>⚠️ Offline`);

  markers[id] = marker;
}

// Aggiorna dimensione marker al resizer
window.addEventListener("resize", () => {
  Object.keys(markers).forEach(id => {
    const m = markers[id];
    const latlng = m.getLatLng();
    map.removeLayer(m);
    createMarker(id, latlng.lat, latlng.lng);
  });
});
// ----- Aggiorna Marker -----
// Funzione helper per convertire gradi in direzione cardinale
function degToDir(deg) {
  if (deg === null || deg === undefined) return "N/D";
  const directions = ["N", "NE", "E", "SE", "S", "SW", "W", "NW"];
  const index = Math.floor(((deg + 22.5) % 360) / 45);
  return directions[index];
}

function updateMarker(id) {
  const type = document.getElementById("tempSelect").value;
  const data = latestData[id];
  if (!data) return;

  let value = null;
  let color = "#808080";

  // Valore e colore
  if (type === "winddirection") {
    value = data.windDir;
    color = data.windGust != null ? getColorRain(data.windGust) : "#808080"; // colore in base alla raffica
  } else {
    switch(type) {
      case "current": value = data.temp; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "max": value = data.tempHigh; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "min": value = data.tempLow; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "dewpt": value = data.dewp; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "dewpMax": value = data.dewpHigh; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "dewpMin": value = data.dewpLow; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "Heat": value = data.heat; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "HeatMax": value = data.heatHigh; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "HeatMin": value = data.heatLow; color = value != null ? getColorTemp(value) : "#808080"; break;
      case "hum": value = data.hum; color = value != null ? getColorHum(value) : "#808080"; break;
      case "humMax": value = data.humHigh; color = value != null ? getColorHum(value) : "#808080"; break;
      case "humMin": value = data.humLow; color = value != null ? getColorHum(value) : "#808080"; break;
      case "rainDay": value = data.rainDaily; color = value != null ? getColorRain(value) : "#808080"; break;
      case "rainRate": value = data.rainRate; color = value != null ? getColorRain(value) : "#808080"; break;
      case "wind": value = data.wind; color = value != null ? getColorRain(value) : "#808080"; break;
      case "windGust": value = data.windGust; color = value != null ? getColorRain(value) : "#808080"; break;
      case "windGustMax": value = data.windGustHigh; color = value != null ? getColorRain(value) : "#808080"; break;
      default: value = null; color = "#808080";
    }
  }

  // Testo pallino
  const displayValue = (value !== undefined && value !== null)
    ? (type === "winddirection" ? degToDir(value) : value.toFixed(1))
    : "N/D";

  // Aggiorna icona
  const icon = L.divIcon({
    className: '',
    html: `<div class="circle-label" style="background-color:${color}; border:2px solid white;">${displayValue}</div>`,
    iconSize: [32, 32],
    iconAnchor: [16, 16]
  });
  markers[id].setIcon(icon);

  if (data.lat != null && data.lon != null) {
    markers[id].setLatLng([data.lat, data.lon]);
  }

  // Popup contestuale
  let popupContent = `<b>Stazione:</b> ${id}<br>`;
  if (type.startsWith("current") || type.startsWith("max") || type.startsWith("min")) {
    popupContent += `🌡️ Attuale: ${data.temp != null ? data.temp.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔺 Max: ${data.tempHigh != null ? data.tempHigh.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔻 Min: ${data.tempLow != null ? data.tempLow.toFixed(1) : "N/D"}°C<br>`;
  } else if (type.startsWith("dew")) {
    popupContent += `🌡️ Attuale: ${data.dewp != null ? data.dewp.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔺 Max: ${data.dewpHigh != null ? data.dewpHigh.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔻 Min: ${data.dewpLow != null ? data.dewpLow.toFixed(1) : "N/D"}°C<br>`;
  } else if (type.startsWith("Heat")) {
    popupContent += `🌡️ Attuale: ${data.heat != null ? data.heat.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔺 Max: ${data.heatHigh != null ? data.heatHigh.toFixed(1) : "N/D"}°C<br>`;
    popupContent += `🔻 Min: ${data.heatLow != null ? data.heatLow.toFixed(1) : "N/D"}°C<br>`;
  } else if (type.startsWith("hum")) {
    popupContent += `💧 Attuale: ${data.hum != null ? data.hum.toFixed(1) : "N/D"}%<br>`;
    popupContent += `🔺 Max: ${data.humHigh != null ? data.humHigh.toFixed(1) : "N/D"}%<br>`;
    popupContent += `🔻 Min: ${data.humLow != null ? data.humLow.toFixed(1) : "N/D"}%<br>`;
  } else if (type.startsWith("rain")) {
    popupContent += `🌧️ Pioggia giorno: ${data.rainDaily != null ? data.rainDaily.toFixed(1) : "N/D"} mm<br>`;
    popupContent += `💦 Rain rate: ${data.rainRate != null ? data.rainRate.toFixed(1) : "N/D"} mm/h<br>`;
  } else if (type.startsWith("wind")) {
    popupContent += `💨 Velocità attuale: ${data.wind != null ? data.wind.toFixed(1) : "N/D"} km/h<br>`;
    popupContent += `🌬️ Raffica: ${data.windGust != null ? data.windGust.toFixed(1) : "N/D"} km/h<br>`;
    popupContent += `🧭 Direzione: ${data.windDir != null ? degToDir(data.windDir) : "N/D"}<br>`;
    popupContent += `🔺 Raffica massima: ${data.windGustHigh != null ? data.windGustHigh.toFixed(1) : "N/D"} km/h<br>`;
  }

  markers[id].setPopupContent(popupContent);
}




async function fetchLimet(id) {
  const st = stationsLimet[id];
  if (!st) return;

  try {
    const response = await fetch(
      "https://api.allorigins.win/get?url=" +
      encodeURIComponent(`https://retelimet.centrometeoligure.it/stazioni/${st.link2}/web/home.php?station=${st.link}`) +
      "&timestamp=" + Date.now()
    );

    const data = await response.json();
    const parser = new DOMParser();
    const doc = parser.parseFromString(data.contents, "text/html");

    const tempTxt = doc.querySelector("#temp")?.textContent?.trim();
    const temp = tempTxt ? parseFloat(tempTxt.replace(",", ".")) : null;

    const tempMaxTxt = doc.querySelector("#temp_max")?.textContent?.trim();
    const tempHigh = tempMaxTxt ? parseFloat(tempMaxTxt.replace(",", ".")) : null;

    const tempMinTxt = doc.querySelector("#temp_min")?.textContent?.trim();
    const tempLow = tempMinTxt ? parseFloat(tempMinTxt.replace(",", ".")) : null;

    // Dew Point
    let dewp = null;
    const scrittineSpans = Array.from(doc.querySelectorAll("span.scrittine"));
    for (let span of scrittineSpans) {
      if (span.textContent.includes("Dew Point")) {
        const valoriSpan = span.parentElement.querySelector("span.valori strong");
        if (valoriSpan) dewp = parseFloat(valoriSpan.textContent.replace(",", "."));
        break;
      }
    }

    // Rain Daily
    let rainDaily = null;
    const tempSpans = Array.from(doc.querySelectorAll("span.temp"));
    for (let span of tempSpans) {
      if (span.parentElement.textContent.includes("Pioggia giorno")) {
        const strong = span.querySelector("strong");
        if (strong) rainDaily = parseFloat(strong.textContent.replace(",", "."));
        break;
      }
    }

    let rainRate = null;
const scrittineSpan = Array.from(doc.querySelectorAll("span.scrittine"));
for (let span of scrittineSpan) {
  if (span.textContent.trim().startsWith("Intensità")) {
    // Prendi il prossimo span con classe 'valori2' nel parent
    const parentDiv = span.parentElement;
    if (parentDiv) {
      const valori2 = parentDiv.querySelector("span.valori2 strong");
      if (valori2) {
        rainRate = parseFloat(valori2.textContent.replace(",", "."));
      }
    }
    break;
  }
}
    latestData[id] = {
      temp, tempHigh, tempLow, dewp, rainDaily, rainRate,
      lat: st.lat, lon: st.lon
    };

    updateMarker(id);

  } catch (err) {
    console.error(`Errore fetch LIMET ${id}:`, err);
  }
}



    // ----- Fetch dati temperatura -----
    async function fetchPws(id) {
      try {
        const urlCurrent = `https://api.weather.com/v2/pws/observations/current?apiKey=${apiKey}&stationId=${stations[id].api}&numericPrecision=decimal&format=json&units=m`;
        const resCurrent = await fetch(urlCurrent);
        const dataCurrent = await resCurrent.json();

        const temp = dataCurrent.observations[0].metric.temp;
        const dewp = dataCurrent.observations [0].metric.dewpt;
        const heat = dataCurrent.observations [0].metric.heatIndex;
        const hum = dataCurrent.observations [0].humidity;
        const rainDaily = dataCurrent.observations [0].metric.precipTotal;
        const rainRate = dataCurrent.observations [0].metric.precipRate;
        const lat = dataCurrent.observations[0].lat;
        const lon = dataCurrent.observations[0].lon;
        const wind = dataCurrent.observations[0].metric.windSpeed;
        const windGust = dataCurrent.observations[0].metric.windGust;
        const altitude = dataCurrent.observations[0].metric.elev;
        const windDir = dataCurrent.observations[0].winddir;


        const urlDaily = `https://api.weather.com/v2/pws/dailysummary/1day?apiKey=${apiKey}&stationId=${stations[id].api}&numericPrecision=decimal&format=json&units=m`;
        const resDaily = await fetch(urlDaily);
        const dataDaily = await resDaily.json();

        const summary = dataDaily.summaries && dataDaily.summaries.length > 0 ? dataDaily.summaries[0].metric : null;
        const tempHigh = summary ? summary.tempHigh : null;
        const tempLow = summary ? summary.tempLow : null;
        const dewpHigh = summary ? summary.dewptHigh : null;
        const dewpLow = summary ? summary.dewptLow : null;
        const heatHigh = summary ? summary.heatindexHigh : null;
        const heatLow = summary ? summary.heatindexLow : null;
        const humHigh = summary ? dataDaily.summaries[0].humidityHigh : null;
        const humLow = summary ? dataDaily.summaries[0].humidityLow : null;
        const windGustHigh = summary ? summary.windgustHigh : null;

        latestData[id] = { temp, tempHigh, tempLow, dewp, dewpHigh, dewpLow, heat, heatHigh, heatLow, hum, humHigh, humLow, rainDaily, rainRate, wind, windGust, windGustHigh, windDir, lat, lon, altitude };
        updateMarker(id);

      } catch(err) {
        console.error(`Errore fetch dati ${id}:`, err);
      }
    }


    async function fetchStations1(id) {
  const st = stations1[id];
  if (!st) return;

  try {
    // Evita CORS e cache
    const url = "https://api.allorigins.win/get?url=" +
      encodeURIComponent(st.link) +
      "&timestamp=" + Date.now();

    const resp = await fetch(url);
    const wrapped = await resp.json();

    // Il contenuto è una stringa JSON nel campo "contents"
    const raw = JSON.parse(wrapped.contents);

    // Parse numerico sicuro (alcuni campi hanno spazi/virgole)
    const toNum = v => v == null ? null : parseFloat(String(v).replace(",", ".").trim());

    const temp      = toNum(raw.temp);
    const tempHigh  = toNum(raw.tempTH);
    const tempLow   = toNum(raw.tempTL);

    const dewp      = toNum(raw.dew);
    const dewpHigh  = toNum(raw.dewpointTH);
    const dewpLow   = toNum(raw.dewpointTL);

    const heat      = toNum(raw.heatindex);
    const heatHigh  = toNum(raw.heatindexTH);
    const heatLow   = raw.wchillTL != null ? toNum(raw.wchillTL) : null; // non esiste heatLow nel JSON

    const hum       = toNum(raw.hum);
    const humHigh   = toNum(raw.humTH);
    const humLow    = toNum(raw.humTL);

    const rainDaily = toNum(raw.rfall);
    const rainRate  = toNum(raw.rrate);

    latestData[id] = {
      temp, tempHigh, tempLow,
      dewp, dewpHigh, dewpLow,
      heat, heatHigh, heatLow,
      hum, humHigh, humLow,
      rainDaily, rainRate,
      lat: st.lat, lon: st.lon
    };

    updateMarker(id);
  } catch (err) {
    console.error(`Errore fetch stations1 ${id}:`, err);
  }
}
async function fetchStations2(id) {
  const st = stations2[id];
  if (!st) return;

  try {
    // Evita CORS e cache
    const url = "https://api.allorigins.win/get?url=" +
      encodeURIComponent(st.link) +
      "&timestamp=" + Date.now();

    const resp = await fetch(url);
    const wrapped = await resp.json();

    // Parse HTML
    const parser = new DOMParser();
    const doc = parser.parseFromString(wrapped.contents, "text/html");

    // Funzione helper per trovare valore in base all'etichetta
    function getValue(label) {
      const row = [...doc.querySelectorAll("tr")].find(tr =>
        tr.textContent.includes(label)
      );
      if (!row) return null;
      const tds = [...row.querySelectorAll("td")].map(td => td.textContent.trim());
      if (!tds[1]) return null;
      return parseFloat(tds[1].replace(",", ".").replace(/[^\d.-]/g, ""));
    }

    // Estrazione valori
    const temp      = getValue("Temperatura");
    const hum       = getValue("umidita");
    const dewp      = getValue("Punto di rugiada");
    const heat      = getValue("Indice di calore") || getValue("Temperatura percepita");
    const rainRate  = getValue("Intensita");
    const rainDaily = getValue("Pioggia");

    latestData[id] = {
      temp,
      hum,
      dewp,
      heat,
      rainRate,
      rainDaily,
      lat: st.lat,
      lon: st.lon
    };

    updateMarker(id);

  } catch (err) {
    console.error(`Errore fetch stations2 ${id}:`, err);
  }
}
async function fetchStations3(id) {
  const st = stations1[id];
  if (!st) return;

  // Crea il marker se non esiste
  if (!markers[id] && st.lat != null && st.lon != null) {
    createMarker(id, st.lat, st.lon);
  }

  try {
    const url = "https://api.allorigins.win/get?url=" +
      encodeURIComponent(st.link) +
      "&timestamp=" + Date.now();

    const resp = await fetch(url);
    const wrapped = await resp.json();

    const raw = JSON.parse(wrapped.contents);

    const toNum = v => v == null ? null : parseFloat(String(v).replace(",", ".").trim());

    const temp      = toNum(raw.temp);
    const tempHigh  = toNum(raw.temp_max);
    const tempLow   = toNum(raw.temp_min);

    const dewp      = toNum(raw.dew_point);
    const heat      = toNum(raw.heat_index);

    const hum       = toNum(raw.hum);

    const rainDaily = toNum(raw.rain);
    const rainRate  = toNum(raw.rain_rate);

    const wind      = toNum(raw.wind_avg);
    const windGust  = toNum(raw.wind_gust);
    const windGustHigh = toNum(raw.wind_gust_max);

    latestData[id] = {
      temp, tempHigh, tempLow,
      dewp, dewpHigh: null, dewpLow: null,
      heat, heatHigh: null, heatLow: null,
      hum, humHigh: null, humLow: null,
      rainDaily, rainRate,
      wind, windGust, windGustHigh,
      lat: st.lat, lon: st.lon
    };

    updateMarker(id);

  } catch (err) {
    console.error(`Errore fetch stations3 ${id}:`, err);
  }
}
async function fetchDMA(id) {
  try {
    const url = "https://script.google.com/macros/s/AKfycbyNgmMhhvfxCkY1e6cYtXcxue5Zb5xBzq0JWv_fDzac-sO6Jrv7w_9js7mmw5VAJfv7cA/exec";
    const res = await fetch(url);
    const data = await res.json();

    // Prende la temperatura dal JSON usando il nome minuscolo
    const key = id.toLowerCase();
    if (data[key]) {
      const temp = data[key].temp;
      const dewp = data[key].dewp;
      const heat = data[key].heat;
      const hum = data[key].hum;
      const wind = data[key].wind;
      const windGust = data[key].gust;
      const rainDaily = data[key].rain;
      const rainRate = data[key].rainrate;
      const lat = stationsDMA[key].lat;
      const lon = stationsDMA[key].lon;

      latestData[id] = { temp, dewp, heat, hum, wind, windGust, rainDaily, rainRate, lat, lon };
      if (typeof updateMarker === "function") updateMarker(id);
    } else {
      console.warn(`Nessun dato trovato per la stazione: ${id}`);
    }

  } catch(err) {
    console.error(`Errore fetch dati ${id}:`, err);
  }
}
  


// ----- Inizializza Marker Wunderground -----
Object.keys(stations).forEach(id => createMarker(id));
Object.keys(stationsDMA).forEach(id => createMarker(id));
Object.keys(stations1).forEach(id => createMarker(id));
Object.keys(stations2).forEach(id => createMarker(id));
Object.keys(stations3).forEach(id => createMarker(id));
Object.keys(stationsLimet).forEach(id => createMarker(id));
Object.keys(stationsBest).forEach(id => createMarker(id));

Object.keys(stations).forEach(id => fetchPws(id));
Object.keys(stationsDMA).forEach(id => fetchDMA(id));
Object.keys(stations1).forEach(id => fetchStations1(id));
Object.keys(stations2).forEach(id => fetchStations2(id));
Object.keys(stations3).forEach(id => fetchStations3(id));
Object.keys(stationsLimet).forEach(id => fetchLimet(id));
Object.keys(stationsBest).forEach(id => fetchPws(id));

    // Aggiornamento ogni 10 secondi
setInterval(() => { Object.keys(stations).forEach(id => fetchPws(id)); }, 60000);
setInterval(() => { Object.keys(stationsDMA).forEach(id => fetchDMA(id)); }, 150000);
setInterval(() => { Object.keys(stations1).forEach(id => fetchStations1(id)); }, 15000);
setInterval(() => { Object.keys(stations2).forEach(id => fetchStations2(id)); }, 135000);
setInterval(() => { Object.keys(stations2).forEach(id => fetchStations3(id)); }, 15000);
setInterval(() => { Object.keys(stationsLimet).forEach(id => fetchLimet(id)); }, 5000);
setInterval(() => {Object.keys(stationsBest).forEach(id => fetchPws(id));}, 5000);

    // Cambia tipo di temperatura
    document.getElementById("tempSelect").addEventListener("change", () => {
  Object.keys(stations).forEach(id => updateMarker(id));
  Object.keys(stationsDMA).forEach(id => updateMarker(id));
  Object.keys(stationsLimet).forEach(id => updateMarker(id));
  Object.keys(stations1).forEach(id => updateMarker(id));
  Object.keys(stations2).forEach(id => updateMarker(id));
  Object.keys(stations3).forEach(id => updateMarker(id));
  Object.keys(stationsBest).forEach(id => updateMarker(id));
    });
  </script>
</body>
</html>